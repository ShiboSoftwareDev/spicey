import { test, expect } from "bun:test"
import { simulate, formatAcResult } from "lib/main"

const net1 = `
Demo of a simple AC circuit

v1 1 0 dc 0 ac 1
r1 1 2 30
c1 2 0 100u
.ac dec 100 1 100

.end
`

test("basics01", () => {
  const result1 = simulate(net1)

  expect(formatAcResult(result1.ac)).toMatchInlineSnapshot(`
    "f(Hz), 1:|V|,∠V(deg), 2:|V|,∠V(deg)
    1.00000, 1.00000,0.00000, 0.999822,-1.07987
    1.02329, 1.00000,0.00000, 0.999814,-1.10502
    1.04713, 1.00000,0.00000, 0.999805,-1.13075
    1.07152, 1.00000,0.00000, 0.999796,-1.15708
    1.09648, 1.00000,0.00000, 0.999786,-1.18403
    1.12202, 1.00000,0.00000, 0.999776,-1.21160
    1.14815, 1.00000,0.00000, 0.999766,-1.23981
    1.17490, 1.00000,0.00000, 0.999755,-1.26868
    1.20226, 1.00000,0.00000, 0.999743,-1.29822
    1.23027, 1.00000,0.00000, 0.999731,-1.32845
    1.25893, 1.00000,0.00000, 0.999719,-1.35938
    1.28825, 1.00000,0.00000, 0.999705,-1.39104
    1.31826, 1.00000,0.00000, 0.999691,-1.42342
    1.34896, 1.00000,0.00000, 0.999677,-1.45657
    1.38038, 1.00000,0.00000, 0.999662,-1.49048
    1.41254, 1.00000,0.00000, 0.999646,-1.52518
    1.44544, 1.00000,0.00000, 0.999629,-1.56069
    1.47911, 1.00000,0.00000, 0.999612,-1.59702
    1.51356, 1.00000,0.00000, 0.999593,-1.63420
    1.54882, 1.00000,0.00000, 0.999574,-1.67225
    1.58489, 1.00000,0.00000, 0.999554,-1.71118
    1.62181, 1.00000,0.00000, 0.999533,-1.75101
    1.65959, 1.00000,0.00000, 0.999511,-1.79177
    1.69824, 1.00000,0.00000, 0.999488,-1.83348
    1.73780, 1.00000,0.00000, 0.999464,-1.87615
    1.77828, 1.00000,0.00000, 0.999439,-1.91982
    1.81970, 1.00000,0.00000, 0.999412,-1.96451
    1.86209, 1.00000,0.00000, 0.999385,-2.01023
    1.90546, 1.00000,0.00000, 0.999356,-2.05701
    1.94984, 1.00000,0.00000, 0.999325,-2.10488
    1.99526, 1.00000,0.00000, 0.999294,-2.15387
    2.04174, 1.00000,0.00000, 0.999260,-2.20399
    2.08930, 1.00000,0.00000, 0.999225,-2.25527
    2.13796, 1.00000,0.00000, 0.999189,-2.30775
    2.18776, 1.00000,0.00000, 0.999151,-2.36144
    2.23872, 1.00000,0.00000, 0.999111,-2.41639
    2.29087, 1.00000,0.00000, 0.999069,-2.47260
    2.34423, 1.00000,0.00000, 0.999025,-2.53012
    2.39883, 1.00000,0.00000, 0.998979,-2.58898
    2.45471, 1.00000,0.00000, 0.998931,-2.64920
    2.51189, 1.00000,0.00000, 0.998881,-2.71081
    2.57040, 1.00000,0.00000, 0.998828,-2.77386
    2.63027, 1.00000,0.00000, 0.998773,-2.83837
    2.69153, 1.00000,0.00000, 0.998715,-2.90437
    2.75423, 1.00000,0.00000, 0.998655,-2.97190
    2.81838, 1.00000,0.00000, 0.998592,-3.04099
    2.88403, 1.00000,0.00000, 0.998526,-3.11169
    2.95121, 1.00000,0.00000, 0.998456,-3.18402
    3.01995, 1.00000,0.00000, 0.998384,-3.25803
    3.09030, 1.00000,0.00000, 0.998308,-3.33375
    3.16228, 1.00000,0.00000, 0.998228,-3.41122
    3.23594, 1.00000,0.00000, 0.998145,-3.49049
    3.31131, 1.00000,0.00000, 0.998058,-3.57158
    3.38844, 1.00000,0.00000, 0.997966,-3.65455
    3.46737, 1.00000,0.00000, 0.997871,-3.73944
    3.54813, 1.00000,0.00000, 0.997771,-3.82629
    3.63078, 1.00000,0.00000, 0.997666,-3.91514
    3.71535, 1.00000,0.00000, 0.997557,-4.00604
    3.80189, 1.00000,0.00000, 0.997442,-4.09904
    3.89045, 1.00000,0.00000, 0.997322,-4.19418
    3.98107, 1.00000,0.00000, 0.997196,-4.29151
    4.07380, 1.00000,0.00000, 0.997065,-4.39109
    4.16869, 1.00000,0.00000, 0.996927,-4.49296
    4.26580, 1.00000,0.00000, 0.996783,-4.59717
    4.36516, 1.00000,0.00000, 0.996632,-4.70377
    4.46684, 1.00000,0.00000, 0.996474,-4.81283
    4.57088, 1.00000,0.00000, 0.996309,-4.92439
    4.67735, 1.00000,0.00000, 0.996136,-5.03851
    4.78630, 1.00000,0.00000, 0.995955,-5.15525
    4.89779, 1.00000,0.00000, 0.995765,-5.27466
    5.01187, 1.00000,0.00000, 0.995567,-5.39680
    5.12861, 1.00000,0.00000, 0.995360,-5.52174
    5.24807, 1.00000,0.00000, 0.995143,-5.64954
    5.37032, 1.00000,0.00000, 0.994915,-5.78025
    5.49541, 1.00000,0.00000, 0.994678,-5.91395
    5.62341, 1.00000,0.00000, 0.994429,-6.05069
    5.75440, 1.00000,0.00000, 0.994169,-6.19055
    5.88844, 1.00000,0.00000, 0.993896,-6.33359
    6.02560, 1.00000,0.00000, 0.993612,-6.47987
    6.16595, 1.00000,0.00000, 0.993313,-6.62948
    6.30957, 1.00000,0.00000, 0.993002,-6.78248
    6.45654, 1.00000,0.00000, 0.992675,-6.93894
    6.60693, 1.00000,0.00000, 0.992334,-7.09894
    6.76083, 1.00000,0.00000, 0.991977,-7.26255
    6.91831, 1.00000,0.00000, 0.991604,-7.42985
    7.07946, 1.00000,0.00000, 0.991213,-7.60091
    7.24436, 1.00000,0.00000, 0.990805,-7.77582
    7.41310, 1.00000,0.00000, 0.990378,-7.95464
    7.58578, 1.00000,0.00000, 0.989931,-8.13748
    7.76247, 1.00000,0.00000, 0.989464,-8.32440
    7.94328, 1.00000,0.00000, 0.988976,-8.51549
    8.12831, 1.00000,0.00000, 0.988465,-8.71083
    8.31764, 1.00000,0.00000, 0.987931,-8.91051
    8.51138, 1.00000,0.00000, 0.987373,-9.11462
    8.70964, 1.00000,0.00000, 0.986790,-9.32324
    8.91251, 1.00000,0.00000, 0.986180,-9.53646
    9.12011, 1.00000,0.00000, 0.985543,-9.75437
    9.33254, 1.00000,0.00000, 0.984877,-9.97707
    9.54993, 1.00000,0.00000, 0.984181,-10.2046
    9.77237, 1.00000,0.00000, 0.983454,-10.4372
    10.0000, 1.00000,0.00000, 0.982695,-10.6747
    10.2329, 1.00000,0.00000, 0.981901,-10.9175
    10.4713, 1.00000,0.00000, 0.981072,-11.1655
    10.7152, 1.00000,0.00000, 0.980206,-11.4188
    10.9648, 1.00000,0.00000, 0.979302,-11.6775
    11.2202, 1.00000,0.00000, 0.978358,-11.9418
    11.4815, 1.00000,0.00000, 0.977373,-12.2117
    11.7490, 1.00000,0.00000, 0.976344,-12.4873
    12.0226, 1.00000,0.00000, 0.975270,-12.7688
    12.3027, 1.00000,0.00000, 0.974149,-13.0561
    12.5893, 1.00000,0.00000, 0.972980,-13.3495
    12.8825, 1.00000,0.00000, 0.971760,-13.6489
    13.1826, 1.00000,0.00000, 0.970487,-13.9545
    13.4896, 1.00000,0.00000, 0.969160,-14.2665
    13.8038, 1.00000,0.00000, 0.967776,-14.5848
    14.1254, 1.00000,0.00000, 0.966333,-14.9095
    14.4544, 1.00000,0.00000, 0.964830,-15.2408
    14.7911, 1.00000,0.00000, 0.963262,-15.5788
    15.1356, 1.00000,0.00000, 0.961629,-15.9234
    15.4882, 1.00000,0.00000, 0.959928,-16.2749
    15.8489, 1.00000,0.00000, 0.958157,-16.6333
    16.2181, 1.00000,0.00000, 0.956312,-16.9986
    16.5959, 1.00000,0.00000, 0.954392,-17.3710
    16.9824, 1.00000,0.00000, 0.952393,-17.7505
    17.3780, 1.00000,0.00000, 0.950314,-18.1371
    17.7828, 1.00000,0.00000, 0.948152,-18.5310
    18.1970, 1.00000,0.00000, 0.945903,-18.9323
    18.6209, 1.00000,0.00000, 0.943565,-19.3408
    19.0546, 1.00000,0.00000, 0.941136,-19.7568
    19.4984, 1.00000,0.00000, 0.938612,-20.1803
    19.9526, 1.00000,0.00000, 0.935991,-20.6112
    20.4174, 1.00000,0.00000, 0.933270,-21.0496
    20.8930, 1.00000,0.00000, 0.930445,-21.4957
    21.3796, 1.00000,0.00000, 0.927515,-21.9493
    21.8776, 1.00000,0.00000, 0.924477,-22.4104
    22.3872, 1.00000,0.00000, 0.921327,-22.8792
    22.9087, 1.00000,0.00000, 0.918062,-23.3556
    23.4423, 1.00000,0.00000, 0.914681,-23.8395
    23.9883, 1.00000,0.00000, 0.911180,-24.3310
    24.5471, 1.00000,0.00000, 0.907557,-24.8301
    25.1189, 1.00000,0.00000, 0.903809,-25.3366
    25.7040, 1.00000,0.00000, 0.899934,-25.8506
    26.3027, 1.00000,0.00000, 0.895929,-26.3719
    26.9153, 1.00000,0.00000, 0.891793,-26.9006
    27.5423, 1.00000,0.00000, 0.887522,-27.4365
    28.1838, 1.00000,0.00000, 0.883115,-27.9796
    28.8403, 1.00000,0.00000, 0.878570,-28.5297
    29.5121, 1.00000,0.00000, 0.873885,-29.0867
    30.1995, 1.00000,0.00000, 0.869058,-29.6506
    30.9030, 1.00000,0.00000, 0.864090,-30.2211
    31.6228, 1.00000,0.00000, 0.858977,-30.7981
    32.3594, 1.00000,0.00000, 0.853719,-31.3815
    33.1131, 1.00000,0.00000, 0.848316,-31.9711
    33.8844, 1.00000,0.00000, 0.842766,-32.5666
    34.6737, 1.00000,0.00000, 0.837070,-33.1680
    35.4813, 1.00000,0.00000, 0.831228,-33.7749
    36.3078, 1.00000,0.00000, 0.825240,-34.3872
    37.1535, 1.00000,0.00000, 0.819106,-35.0046
    38.0189, 1.00000,0.00000, 0.812827,-35.6269
    38.9045, 1.00000,0.00000, 0.806405,-36.2538
    39.8107, 1.00000,0.00000, 0.799841,-36.8851
    40.7380, 1.00000,0.00000, 0.793136,-37.5204
    41.6869, 1.00000,0.00000, 0.786293,-38.1596
    42.6580, 1.00000,0.00000, 0.779314,-38.8022
    43.6516, 1.00000,0.00000, 0.772202,-39.4480
    44.6684, 1.00000,0.00000, 0.764959,-40.0967
    45.7088, 1.00000,0.00000, 0.757589,-40.7479
    46.7735, 1.00000,0.00000, 0.750096,-41.4013
    47.8630, 1.00000,0.00000, 0.742483,-42.0567
    48.9779, 1.00000,0.00000, 0.734754,-42.7135
    50.1187, 1.00000,0.00000, 0.726915,-43.3716
    51.2861, 1.00000,0.00000, 0.718969,-44.0306
    52.4807, 1.00000,0.00000, 0.710922,-44.6900
    53.7032, 1.00000,0.00000, 0.702778,-45.3497
    54.9541, 1.00000,0.00000, 0.694544,-46.0091
    56.2341, 1.00000,0.00000, 0.686224,-46.6680
    57.5440, 1.00000,0.00000, 0.677825,-47.3261
    58.8844, 1.00000,0.00000, 0.669353,-47.9828
    60.2560, 1.00000,0.00000, 0.660813,-48.6381
    61.6595, 1.00000,0.00000, 0.652212,-49.2914
    63.0957, 1.00000,0.00000, 0.643556,-49.9425
    64.5654, 1.00000,0.00000, 0.634852,-50.5910
    66.0693, 1.00000,0.00000, 0.626106,-51.2366
    67.6083, 1.00000,0.00000, 0.617324,-51.8790
    69.1831, 1.00000,0.00000, 0.608513,-52.5179
    70.7946, 1.00000,0.00000, 0.599680,-53.1530
    72.4436, 1.00000,0.00000, 0.590830,-53.7841
    74.1310, 1.00000,0.00000, 0.581971,-54.4107
    75.8578, 1.00000,0.00000, 0.573109,-55.0327
    77.6247, 1.00000,0.00000, 0.564249,-55.6498
    79.4328, 1.00000,0.00000, 0.555399,-56.2618
    81.2831, 1.00000,0.00000, 0.546564,-56.8684
    83.1764, 1.00000,0.00000, 0.537750,-57.4694
    85.1138, 1.00000,0.00000, 0.528963,-58.0646
    87.0964, 1.00000,0.00000, 0.520208,-58.6538
    89.1251, 1.00000,0.00000, 0.511491,-59.2368
    91.2011, 1.00000,0.00000, 0.502817,-59.8134
    93.3254, 1.00000,0.00000, 0.494191,-60.3836
    95.4993, 1.00000,0.00000, 0.485618,-60.9470
    97.7237, 1.00000,0.00000, 0.477103,-61.5036
    100.000, 1.00000,0.00000, 0.468650,-62.0533"
  `)
})
